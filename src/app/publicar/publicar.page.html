<app-header></app-header>

<ion-content fullscreen="false" class="ion-padding">
  <ion-card class="card-n-prenda">
    <ion-card-header>
      <ion-card-title>Nueva Prenda</ion-card-title>
    </ion-card-header>
    <ion-card-content>

      <form [formGroup]="publicarForm" (ngSubmit)="publicarPrenda()">
        <!-- Tomar foto -->
        <ion-item>    
          <ion-label >Imagen</ion-label>      
          <ion-button expand="block" (click)="tomarFoto()">
            Tomar Foto
          </ion-button>
        </ion-item>
        <ion-item *ngIf="imagenBase64">
          <ion-img [src]="imagenBase64"></ion-img>
        </ion-item>

        <!-- Título -->
        <ion-item>
          <ion-label position="floating">Título</ion-label>
          <ion-input formControlName="titulo" type="text"></ion-input>
        </ion-item>

        <!-- Descripción -->
        <ion-item>
          <ion-label position="floating">Descripción</ion-label>
          <ion-textarea formControlName="descripcion"></ion-textarea>
        </ion-item>

        <!-- Tipo -->   
        <ion-item class="select-fake" lines="full">
          <ion-label position="stacked">Tipo</ion-label>
          <div class="select-box" (click)="toggleTipo()">
            <div class="selected-option">
              {{ publicarForm.value.tipo || 'Seleccionar tipo' }}
              <ion-icon name="chevron-down-outline"></ion-icon>
            </div>
          </div>
        </ion-item>
        <div *ngIf="tipoAbierto" class="options-box-wrapper">
          <div class="options-box">
            <div *ngFor="let tipo of ['Polera', 'Pantalón', 'Vestido', 'Chaqueta']"
                class="option"
                [class.selected]="publicarForm.value.tipo === tipo"
                (click)="publicarForm.patchValue({ tipo }); tipoAbierto = false">
              {{ tipo }}
            </div>
          </div>
        </div>


        <!-- Estado -->
        <ion-item class="select-fake" lines="full">
          <ion-label position="stacked">Estado</ion-label>
          <div class="select-box" (click)="toggleEstado()">
            <div class="selected-option">
              {{ publicarForm.value.estado || 'Seleccionar estado' }}
              <ion-icon name="chevron-down-outline"></ion-icon>
            </div>
          </div>
        </ion-item>
        <div *ngIf="estadoAbierto" class="options-box-wrapper">
          <div class="options-box">
            <div *ngFor="let estado of ['Nuevo', 'Como nueva', 'Usado']"
                class="option"
                [class.selected]="publicarForm.value.estado === estado"
                (click)="publicarForm.patchValue({ estado }); estadoAbierto = false">
              {{ estado }}
            </div>
          </div>
        </div>



        <!-- Talla -->
        <ion-item class="select-fake" lines="full">
          <ion-label position="stacked">Talla</ion-label>
          <div class="select-box" (click)="toggleTalla()">
            <div class="selected-option">
              {{ publicarForm.value.talla || 'Seleccionar talla' }}
              <ion-icon name="chevron-down-outline"></ion-icon>
            </div>
          </div>
        </ion-item>
        <div *ngIf="tallaAbierta" class="options-box-wrapper">
          <div class="options-box">
            <div *ngFor="let talla of ['S', 'M', 'L', 'XL']"
                class="option"
                [class.selected]="publicarForm.value.talla === talla"
                (click)="publicarForm.patchValue({ talla }); tallaAbierta = false">
              {{ talla }}
            </div>
          </div>
        </div>


        <!-- Ubicación -->
        <ion-item class="select-fake" lines="full">
          <ion-label position="stacked">Ubicación</ion-label>
          <div class="select-box" (click)="toggleUbicacion()">
            <div class="selected-option">
              {{ publicarForm.value.ubicacion || 'Seleccionar ubicación' }}
              <ion-icon name="chevron-down-outline"></ion-icon>
            </div>
          </div>
        </ion-item>
        <div *ngIf="ubicacionAbierta" class="options-box-wrapper">
          <div class="options-box">
            <div *ngFor="let ubicacion of ['Santiago', 'Valparaíso', 'Concepción']"
                class="option"
                [class.selected]="publicarForm.value.ubicacion === ubicacion"
                (click)="publicarForm.patchValue({ ubicacion }); ubicacionAbierta = false">
              {{ ubicacion }}
            </div>
          </div>
        </div>



        <!-- Precio -->
        <ion-item>
          <ion-label position="floating">Precio</ion-label>
          <ion-input formControlName="precio" type="number"></ion-input>
        </ion-item>

        <!-- Botón -->
        <ion-button expand="block" type="submit" class="ion-margin-top">
          Publicar Prenda
        </ion-button>
      </form>

    </ion-card-content>
  </ion-card>
</ion-content>

<ion-footer>
  <ion-toolbar color="dark">
    <ion-title size="small" class="ion-text-center">
      Copyright © ReVístete 2025
    </ion-title>
  </ion-toolbar>
</ion-footer>
